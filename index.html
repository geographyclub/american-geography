<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,700" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,600,800" rel="stylesheet">
<link rel="stylesheet" href="style.css">
<title>American Geography</title>
</head>
<body>

<header>
<div><a href="#"><h1 style="font-size:14px"><span>american</span><span style="color:#46bfbd">geography</span></h1></a></div>
<div class="menu-icon">&#9776;</div>
<nav>
<a href="#" onclick="closeMenu()">Home</a>
<a href="https://geographyclub.github.io/asean/" target="_blank">Asean Primer</a>
<!--<a href="#" onclick="scrollToSection('Brunei');">Brunei</a>-->
</nav>
</header>

<div class="container" id="jsonBanner"></div>
<div class="container" id="jsonContainer"></div>

<!--<div class="border-container"><div class="color-block"></div><div class="color-block"></div><div class="color-block"></div></div>-->

<script>
const labelsUrl = 'https://raw.githubusercontent.com/geographyclub/american-geography/main/json/dp02_labels.json';

// Function to check if a value is valid
function isValidValue(value) {
  return value !== "null" && value !== "{X}" && value !== null && value !== undefined;
}

// Function to fetch a random key from Labels and check its value in three different files
function fetchRandomKeyAndCheckValue(labelsData, files, thirdFileUrl) {
  // Select a random object from the labels array
  const randomLabelObject = labelsData[Math.floor(Math.random() * labelsData.length)];

  // Extract the randomly chosen key and value from labels
  const randomKey = Object.keys(randomLabelObject)[0];
  const lowercasedKey = randomKey.toLowerCase();
  const valueFromLabels = randomLabelObject[randomKey].split('!!');

  // Log the result
  console.log(`Random Key from Labels: ${lowercasedKey}`);
  console.log(`Value from Labels: ${valueFromLabels}`);

  // Choose three different random files from the list
  let randomFile1, randomFile2;
  do {
    randomFile1 = files[Math.floor(Math.random() * files.length)];
    randomFile2 = files[Math.floor(Math.random() * files.length)];
  } while (randomFile1 === randomFile2); // Ensure randomFile2 is different from randomFile1

  const fileUrl1 = `https://raw.githubusercontent.com/geographyclub/american-geography/main/json/states/dp02_${randomFile1}`;
  const fileUrl2 = `https://raw.githubusercontent.com/geographyclub/american-geography/main/json/states/dp02_${randomFile2}`;

  // Fetch the JSON files corresponding to the random files
  return Promise.all([
    fetch(fileUrl1).then(response => response.json()),
    fetch(fileUrl2).then(response => response.json()),
    fetch(thirdFileUrl).then(response => response.json()) // Fetch the third file
  ])
    .then(([fileData1, fileData2, thirdFileData]) => {
      // Find the value corresponding to the lowercase randomly chosen key in the first file
      const randomValue1 = fileData1.find(obj => obj.hasOwnProperty(lowercasedKey))?.[lowercasedKey];

      // Find the value corresponding to the lowercase randomly chosen key in the second file
      const randomValue2 = fileData2.find(obj => obj.hasOwnProperty(lowercasedKey))?.[lowercasedKey];

      // Find the value corresponding to the lowercase randomly chosen key in the third file
      const randomValue3 = thirdFileData.find(obj => obj.hasOwnProperty(lowercasedKey))?.[lowercasedKey];

      // Log the results
      const container = document.getElementById('jsonContainer');
      const jsonItem = document.createElement('div');
      jsonItem.classList.add('item');

      // Update the HTML content with the retrieved values
      jsonItem.innerHTML = `
      <div class="flex-container">

      <div class="flex-column-wide"><h2>${valueFromLabels.slice(1)}</h2></div>
        <h1>${randomFile1}</h1>
        <h2>${lowercasedKey}</h2>
        <p>Random Value 1: ${isValidValue(randomValue1) ? randomValue1 : 'Invalid'}</p>
        
        <h1>${randomFile2}</h1>
        <h2>${lowercasedKey}</h2>
        <p>Random Value 2: ${isValidValue(randomValue2) ? randomValue2 : 'Invalid'}</p>
        
        <h1>${thirdFileUrl}</h1>
        <h2>${lowercasedKey}</h2>
        <p>Random Value 3: ${isValidValue(randomValue3) ? randomValue3 : 'Invalid'}</p>
</div>
      `;

      // Append the new div to the resultContainer
      container.appendChild(jsonItem);
    })
    .catch(error => console.error('Error fetching JSON files:', error));
}

// Function to repeat the script a specified number of times
function runScriptMultipleTimes(numTimes) {
  // Fetch the labels JSON file
  fetch(labelsUrl)
    .then(response => response.json())
    .then(labelsData => {
      // Now, choose random files from the list
      const files = [
        "alabama.json", "alaska.json", "arizona.json", "arkansas.json", "california.json",
        "colorado.json", "connecticut.json", "delaware.json", "districtofcolumbia.json", "florida.json",
        "georgia.json", "hawaii.json", "idaho.json", "illinois.json", "indiana.json", "iowa.json",
        "kansas.json", "kentucky.json", "louisiana.json", "maine.json", "maryland.json", "massachusetts.json",
        "michigan.json", "minnesota.json", "mississippi.json", "missouri.json", "montana.json", "nebraska.json",
        "nevada.json", "newhampshire.json", "newjersey.json", "newmexico.json", "newyork.json", "northcarolina.json",
        "northdakota.json", "ohio.json", "oklahoma.json", "oregon.json", "pennsylvania.json", "puertorico.json",
        "rhodeisland.json", "southcarolina.json", "southdakota.json", "tennessee.json", "texas.json", "utah.json",
        "vermont.json", "virginia.json", "washington.json", "westvirginia.json", "wisconsin.json", "wyoming.json"
      ];

      // Specify the URL for the third file
      const thirdFileUrl = 'https://raw.githubusercontent.com/geographyclub/american-geography/main/json/us/dp02_us.json';

      // Run the script multiple times
      for (let i = 0; i < numTimes; i++) {
        console.log(`\n=== Run ${i + 1} ===`);
        fetchRandomKeyAndCheckValue(labelsData, files, thirdFileUrl);
      }
    })
    .catch(error => console.error('Error fetching JSON labels:', error));
}

// Call the function to run the script 10 times
runScriptMultipleTimes(10);
</script>

<!-- close menu -->
<script>
document.querySelector('.menu-icon').addEventListener('click', function () {
document.querySelector('nav').classList.toggle('show');
});
function closeMenu() {
document.querySelector('nav').classList.remove('show');
}
</script>

<!-- scroll to section with offset -->
<script>
function scrollToSection(sectionId) {
const targetSection = document.getElementById(sectionId);
const offset = 50;

if (targetSection) {
window.scrollTo({
top: targetSection.offsetTop - offset,
behavior: 'smooth'
});
}
event.preventDefault();
closeMenu();
}
</script>

</body>
</html>
